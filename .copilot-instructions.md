# GitHub Copilot Chat Instructions for SuaviUI

## Purpose
These instructions guide GitHub Copilot Chat interactions when contributing to the SuaviUI World of Warcraft addon project.

---

## Knowledge Base

### Project Documentation
- **Location:** `/docs/` folder
- **Current Documents:**
  - `WoW_12.0.0_API_Changes.docx` - API changes for WoW patch 12.0.0
- **Usage:** Always check these documents for compatibility information before suggesting changes to core functionality.

### Project Structure
- **Addon Files:** `/utils/` - Main addon functionality (sui_*.lua files)
- **UI Skinning:** `/skinning/` - Visual customization for WoW UI elements
- **Libraries:** `/libs/` - Ace3 and other dependencies
- **Localization:** `/Locales/` - Multi-language support files
- **Configuration:** `SuaviUI.toc` - Addon manifest file

### Key Technologies
- **Language:** Lua (World of Warcraft scripting)
- **Framework:** Ace3 (AceAddon, AceDB, AceConsole, AceEvent, AceLocale)
- **Libraries:** LibSerialize, LibDeflate, LibCustomGlow, LibKeyBound, etc.

---

## Code Quality Requirements

### Verification
Before suggesting or implementing changes:
1. **Compatibility Check** - Verify changes don't break existing functionality
2. **WoW API Validation** - Check `/docs/` for any API changes that might affect the code
3. **Lua Syntax** - Ensure all Lua code follows proper syntax
4. **Dependencies** - Confirm all required libraries are available
5. **Test Scenarios** - Consider edge cases and user scenarios

### Atomic Changes
- **One Concern Per Change:** Each commit should address a single feature/fix
- **Small Commits:** Keep changes focused and reviewable
- **Clear Intent:** Each change should have a clear, single purpose
- **No Mixed Issues:** Don't combine multiple unrelated fixes in one commit
- **Rollback Friendly:** Changes should be easily reversible if needed

### Commit Message Format
```
<type>: <brief description>

<optional detailed explanation>
```

**Types:**
- `feat:` - New feature
- `fix:` - Bug fix
- `refactor:` - Code restructuring
- `style:` - Formatting/style changes
- `docs:` - Documentation updates
- `chore:` - Maintenance tasks

**Examples:**
- `feat: add combat timer widget`
- `fix: resolve castbar positioning on ultrawide monitors`
- `refactor: extract frame positioning logic into helper function`

---

## Development Guidelines

### Lua Best Practices
1. **Naming Conventions:**
   - Functions: `camelCase` or `snake_case`
   - Local variables: `camelCase`
   - Constants: `UPPER_CASE`
   - Addon prefix: `SuaviUI`

2. **Code Structure:**
   - Use local functions for encapsulation
   - Group related functionality together
   - Add comments for complex logic
   - Use meaningful variable names

3. **Performance Considerations:**
   - Avoid excessive frame updates
   - Use event-driven architecture when possible
   - Cache frequently accessed values
   - Minimize table allocations in hot paths

4. **Function Definition Order:**
   - Define functions BEFORE referencing them in scripts
   - When a function is called in `SetScript()` callbacks, define it before the callback
   - This avoids "attempt to call method 'FunctionName' (a nil value)" errors
   - Example: Define `RelayoutTabs()` before `frame:SetScript("OnSizeChanged", ...)`

### WoW-Specific Considerations
1. **API Compatibility:** Always check for version-specific API differences
2. **Frame Management:** Properly anchor and resize frames
3. **Event Handling:** Unregister events when frames are hidden
4. **Memory Leaks:** Avoid circular references and properly clean up resources

### Testing
- Test in actual World of Warcraft client when possible
- Verify with multiple resolutions and aspect ratios
- Check performance impact with frame rate monitoring
- Validate with different addons loaded

---

## Change Review Checklist

Before committing any changes:
- [ ] Code follows Lua best practices
- [ ] Changes are atomic and focused
- [ ] Commit message is clear and follows format
- [ ] WoW compatibility verified via `/docs/`
- [ ] No syntax errors
- [ ] Dependencies are available
- [ ] Performance impact considered
- [ ] Related functionality tested
- [ ] Comments added for complex logic
- [ ] No breaking changes to existing features

---

## Common Tasks

### Adding a New Feature
1. Create a new file in `/utils/sui_<feature>.lua`
2. Follow naming conventions
3. Implement feature-specific options in `/utils/sui_<feature>_options.lua` if needed
4. Register with the main options panel
5. Update locale files if adding UI strings
6. Add to credits if using external libraries
7. Test thoroughly in WoW

### Fixing a Bug
1. Identify the root cause
2. Check `/docs/` for related API changes
3. Make minimal changes to fix the issue
4. Test with edge cases
5. Create focused commit with clear message

### Updating Dependencies
1. Verify new library version compatibility
2. Check for breaking changes
3. Update license files if required
4. Test all dependent features
5. Document changes in commit message

### Localizing Text
1. Add English text to `/Locales/enUS.lua`
2. Create entries in other language files
3. Use `L["key"]` syntax for localization
4. Keep keys descriptive and unique

---

## When to Escalate
- API compatibility questions → Check `/docs/`
- Architecture decisions → Consider addon scope and performance
- Library updates → Verify version compatibility
- Breaking changes → Document thoroughly in commit

---

## Resources

### External Documentation
- [World of Warcraft API Documentation](https://wowpedia.fandom.com/)
- [Ace3 Documentation](https://www.wowace.com/projects/ace3)
- [Lua Reference Manual](https://www.lua.org/manual/)

### Related Files
- `SuaviUI.toc` - Addon manifest and dependencies
- `load.xml` - File loading order
- `utils/sui_options.lua` - Options panel structure
- `Locales/locales.xml` - Locale file references

---

## Notes

- This addon is **public** and used by the WoW community
- Maintain backward compatibility when possible
- Document significant changes in commit messages
- Consider performance impact of all changes
- Keep the codebase maintainable and readable

**Last Updated:** January 27, 2026
